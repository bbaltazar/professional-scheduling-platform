<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√âlite Professional Suite</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Luxury design system stylesheet -->
    <link rel="stylesheet" href="/static/css/luxury.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #0d0d0d 100%);
            color: #D4AF37;
            min-height: 100vh;
            position: relative;
        }

        .back-link {
            position: fixed;
            top: 30px;
            left: 30px;
            color: #D4AF37;
            text-decoration: none;
            font-weight: 500;
            padding: 12px 20px;
            background: rgba(212, 175, 55, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 50px;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-link:hover {
            background: rgba(212, 175, 55, 0.2);
            transform: translateX(-5px);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 40px 60px;
        }

        /* Add space for fixed tabs when authenticated */
        .sections-grid {
            padding-top: 80px;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #D4AF37, #F7E7AD);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }

        .header .subtitle {
            color: rgba(212, 175, 55, 0.8);
            font-size: 1.1rem;
            font-weight: 300;
        }

        .sections-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
        }

        .section {
            background: rgba(212, 175, 55, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 20px;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #D4AF37, #F7E7AD);
        }

        /* Tab Navigation Styles */
        .tab-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 40px;
            overflow-x: auto;
            padding: 15px 40px;
            border-bottom: 2px solid rgba(212, 175, 55, 0.2);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.98) 0%, rgba(26, 26, 26, 0.98) 100%);
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .tab-button {
            padding: 15px 30px;
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 12px 12px 0 0;
            color: rgba(212, 175, 55, 0.8);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 3px solid transparent;
        }

        .tab-button:hover {
            background: rgba(212, 175, 55, 0.1);
            color: #D4AF37;
            transform: translateY(-2px);
        }

        .tab-button.active {
            background: rgba(212, 175, 55, 0.15);
            border-color: rgba(212, 175, 55, 0.4);
            border-bottom-color: #D4AF37;
            color: #D4AF37;
            font-weight: 600;
        }

        .tab-button .tab-icon {
            font-size: 1.2rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section h2 {
            font-family: 'Playfair Display', serif;
            color: #D4AF37;
            margin-bottom: 30px;
            font-size: 1.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-icon {
            font-size: 1.5rem;
            filter: drop-shadow(0 2px 4px rgba(255, 215, 0, 0.3));
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            letter-spacing: 0.3px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #ffffff;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #D4AF37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
            background: rgba(212, 175, 55, 0.08);
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .btn {
            background: linear-gradient(135deg, #D4AF37, #F7E7AD);
            color: #000;
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            letter-spacing: 0.3px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }

        .btn-add {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-left: 15px;
            padding: 12px 25px;
            font-size: 0.9rem;
        }

        .btn-add:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.1);
        }

        .dynamic-item {
            background: rgba(212, 175, 55, 0.05);
            padding: 25px;
            margin: 15px 0;
            border-radius: 15px;
            border-left: 4px solid #D4AF37;
            position: relative;
            transition: all 0.3s ease;
        }

        .dynamic-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(5px);
        }

        .existing-services-container {
            display: grid;
            gap: 20px;
            margin-bottom: 20px;
        }

        .existing-service-card {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 25px;
            position: relative;
            transition: all 0.3s ease;
        }

        .existing-service-card:hover {
            background: rgba(212, 175, 55, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }

        .service-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .service-card-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: #D4AF37;
            margin: 0;
        }

        .service-card-actions {
            display: flex;
            gap: 10px;
        }

        .btn-edit,
        .btn-delete {
            padding: 8px 16px;
            font-size: 0.9rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-edit {
            background: rgba(212, 175, 55, 0.2);
            color: #D4AF37;
            border: 1px solid rgba(212, 175, 55, 0.4);
        }

        .btn-edit:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: translateY(-1px);
        }

        .btn-delete {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.4);
        }

        .btn-delete:hover {
            background: rgba(220, 53, 69, 0.3);
            transform: translateY(-1px);
        }

        .service-card-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            color: rgba(255, 255, 255, 0.8);
        }

        .service-detail {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Workplace Card Styles */
        .workplaces-container {
            display: grid;
            gap: 20px;
        }

        .workplace-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .workplace-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }

        .yelp-results {
            margin-top: 20px;
        }

        .yelp-business-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .yelp-business-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(212, 175, 55, 0.5);
        }

        .loading-message {
            text-align: center;
            color: rgba(212, 175, 55, 0.7);
            padding: 20px;
            font-style: italic;
        }

        .info-message {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid rgba(33, 150, 243, 0.3);
            color: rgba(33, 150, 243, 0.9);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .service-detail-icon {
            font-size: 1.1rem;
        }

        .service-detail-value {
            font-weight: 500;
        }

        .service-edit-form {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(212, 175, 55, 0.2);
        }

        .service-edit-form .form-grid {
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .service-edit-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn-save,
        .btn-cancel {
            padding: 10px 20px;
            font-size: 0.9rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-save {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .btn-save:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-cancel {
            background: rgba(108, 117, 125, 0.2);
            color: #6c757d;
            border: 1px solid rgba(108, 117, 125, 0.4);
        }

        .btn-cancel:hover {
            background: rgba(108, 117, 125, 0.3);
            transform: translateY(-1px);
        }

        .response {
            margin-top: 20px;
            padding: 20px;
            border-radius: 12px;
            display: none;
            font-weight: 500;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .response.success {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #22c55e;
        }

        .response.error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05));
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        /* Floating particles effect */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            animation: float-particle 15s infinite linear;
        }

        @keyframes float-particle {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                transform: translateY(-10vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 100px 20px 40px;
            }

            .header h1 {
                font-size: 2.2rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .section {
                padding: 30px 25px;
            }
        }

        /* Bookings Styles */
        .bookings-container {
            display: grid;
            gap: 20px;
        }

        .booking-card {
            background: rgba(212, 175, 55, 0.08);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
        }

        .booking-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.1);
        }

        /* Client name link in booking cards */
        .booking-card a {
            position: relative;
            display: inline-block;
        }

        .booking-card a::after {
            content: '‚Üí';
            margin-left: 4px;
            opacity: 0;
            transition: opacity 0.2s, margin-left 0.2s;
        }

        .booking-card a:hover::after {
            opacity: 0.7;
            margin-left: 8px;
        }

        /* Stopwatch Button Styles */
        .stopwatch-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            margin-top: 18px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .stopwatch-btn {
            position: relative;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .stopwatch-btn-start {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .stopwatch-btn-start:hover {
            transform: scale(1.08);
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.4);
        }

        .stopwatch-btn-start:active {
            transform: scale(1.02);
        }

        .stopwatch-btn-stop {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            animation: pulse-stop 2s ease-in-out infinite;
        }

        .stopwatch-btn-stop:hover {
            transform: scale(1.08);
            box-shadow: 0 8px 30px rgba(239, 68, 68, 0.4);
            animation: none;
        }

        .stopwatch-btn-stop:active {
            transform: scale(1.02);
        }

        @keyframes pulse-stop {

            0%,
            100% {
                box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
            }

            50% {
                box-shadow: 0 8px 30px rgba(239, 68, 68, 0.6);
            }
        }

        .stopwatch-icon {
            font-size: 32px;
            line-height: 1;
        }

        .stopwatch-text {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1.2;
            text-align: center;
            max-width: 90px;
        }

        .stopwatch-timer {
            font-size: 28px;
            font-weight: 700;
            color: #FFD700;
            font-family: 'Monaco', 'Courier New', monospace;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        .stopwatch-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stopwatch-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            color: #10b981;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: blink 1.5s ease-in-out infinite;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        .stopwatch-status::before {
            content: '';
            width: 6px;
            height: 6px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse-dot 1.5s ease-in-out infinite;
        }

        @keyframes pulse-dot {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.5);
                opacity: 0.7;
            }
        }

        .booking-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .booking-client-info {
            flex: 1;
            min-width: 200px;
        }

        .booking-client-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: #D4AF37;
            margin-bottom: 5px;
        }

        .booking-client-email {
            color: rgba(212, 175, 55, 0.8);
            font-size: 0.95rem;
        }

        .booking-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .booking-status.confirmed {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .booking-status.completed {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .booking-status.cancelled {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .booking-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .booking-detail {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .booking-detail-icon {
            font-size: 1.1rem;
            width: 25px;
            text-align: center;
        }

        .booking-detail-value {
            color: rgba(212, 175, 55, 0.9);
            font-weight: 500;
        }

        .booking-service-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #D4AF37;
        }

        .booking-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn-booking-action {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-complete {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .btn-complete:hover {
            background: rgba(34, 197, 94, 0.3);
        }

        .btn-cancel {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .btn-cancel:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .no-bookings-message {
            text-align: center;
            color: rgba(212, 175, 55, 0.6);
            font-style: italic;
            padding: 60px 20px;
            background: rgba(212, 175, 55, 0.03);
            border-radius: 15px;
            border: 1px dashed rgba(212, 175, 55, 0.3);
        }

        .booking-notes {
            background: rgba(212, 175, 55, 0.05);
            border-left: 3px solid rgba(212, 175, 55, 0.3);
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
            color: rgba(212, 175, 55, 0.8);
            font-style: italic;
        }

        .loading-message {
            text-align: center;
            color: rgba(212, 175, 55, 0.6);
            padding: 40px;
            font-style: italic;
        }

        /* Calendar Management Styles */
        .days-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 8px;
        }

        .day-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .day-option:hover {
            background: rgba(212, 175, 55, 0.2);
        }

        .day-option input[type="checkbox"] {
            margin-right: 6px;
            accent-color: #D4AF37;
        }

        .day-option input[type="checkbox"]:checked+.day-option {
            background: rgba(212, 175, 55, 0.3);
            border-color: #D4AF37;
        }

        /* Weekly Calendar Styles */
        .calendar-wrapper {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
        }

        .weekly-calendar {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
            gap: 1px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            user-select: none;
        }

        .time-column {
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

        .time-header {
            height: 50px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .time-label {
            display: flex;
            align-items: flex-start;
            justify-content: flex-end;
            padding-right: 12px;
            padding-top: 0;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
        }

        .day-column {
            background: rgba(255, 255, 255, 0.02);
            display: flex;
            flex-direction: column;
        }

        .day-header {
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            color: #FFD700;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
            background: rgba(255, 215, 0, 0.05);
        }

        .time-slots {
            position: relative;
            height: 680px;
            background:
                repeating-linear-gradient(to bottom,
                    rgba(255, 255, 255, 0.05) 0px,
                    rgba(255, 255, 255, 0.05) 1px,
                    transparent 1px,
                    transparent 20px,
                    rgba(255, 255, 255, 0.15) 20px,
                    rgba(255, 255, 255, 0.15) 21px,
                    transparent 21px,
                    transparent 40px);
            min-height: 200px;
            transition: height 0.3s ease;
        }

        .time-slot {
            position: absolute;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.7), rgba(255, 165, 0, 0.7));
            border: 2px solid #FFD700;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: #000;
            overflow: hidden;
        }

        .time-slot:hover {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.9), rgba(255, 165, 0, 0.9));
            transform: scale(1.02);
            z-index: 10;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
        }

        .time-slot .delete-btn {
            position: absolute;
            top: 2px;
            right: 2px;
            background: rgba(255, 0, 0, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            line-height: 1;
            z-index: 3;
        }

        .time-slot:hover .delete-btn {
            display: flex;
        }

        .resize-handle {
            position: absolute;
            left: 0;
            right: 0;
            height: 8px;
            background: transparent;
            cursor: ns-resize;
            z-index: 2;
            display: none;
        }

        .resize-handle-top {
            top: -4px;
        }

        .resize-handle-bottom {
            bottom: -4px;
        }

        .resize-handle::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 3px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 2px;
        }

        .time-slot:hover .resize-handle {
            display: block;
        }

        .time-slot.resizing {
            opacity: 0.8;
        }

        .selection-preview {
            position: absolute;
            background: rgba(255, 215, 0, 0.3);
            border: 2px dashed #FFD700;
            pointer-events: none;
            border-radius: 6px;
        }

        .btn-small {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 50px;
            color: #FFD700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-small:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: #FFD700;
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .modal-header h3 {
            color: #FFD700;
            font-size: 1.5rem;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: #FFD700;
        }

        .modal-body {
            margin-bottom: 30px;
        }

        .modal-footer {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }

        .checkbox-label input[type="checkbox"] {
            margin-right: 8px;
            accent-color: #D4AF37;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23D4AF37' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 20px;
            padding-right: 40px;
        }

        .schedules-list {
            margin-top: 20px;
        }

        .schedule-item,
        .pto-item {
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .schedule-item:hover,
        .pto-item:hover {
            background: rgba(212, 175, 55, 0.08);
            border-color: rgba(212, 175, 55, 0.4);
        }

        .schedule-header,
        .pto-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .schedule-title,
        .pto-title {
            font-size: 18px;
            font-weight: 600;
            color: #D4AF37;
        }

        .schedule-info,
        .pto-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
        }

        .info-label {
            font-size: 12px;
            color: rgba(212, 175, 55, 0.7);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .info-value {
            font-size: 14px;
            color: #D4AF37;
            font-weight: 500;
        }

        .schedule-actions,
        .pto-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #b91c1c 0%, #991b1b 100%);
        }

        .section-subtitle {
            color: rgba(212, 175, 55, 0.8);
            font-size: 14px;
            margin-bottom: 20px;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .booking-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .booking-details {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .booking-actions {
                justify-content: center;
            }

            .days-selector {
                flex-direction: column;
            }

            .schedule-info,
            .pto-info {
                grid-template-columns: 1fr;
            }

            .schedule-actions,
            .pto-actions {
                flex-direction: column;
            }
        }

        /* Clients Section Styles */
        .clients-list {
            margin-top: 20px;
            overflow-x: auto;
        }

        .clients-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            overflow: hidden;
        }

        .clients-table thead {
            background: rgba(212, 175, 55, 0.15);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .clients-table th {
            padding: 16px;
            text-align: left;
            color: #D4AF37;
            font-weight: 600;
            border-bottom: 2px solid rgba(212, 175, 55, 0.3);
            cursor: pointer;
            user-select: none;
            white-space: nowrap;
            transition: background 0.2s ease;
            background: rgba(0, 0, 0, 0.95);
            position: sticky;
            top: 0;
        }

        .clients-table th:hover {
            background: rgba(212, 175, 55, 0.25);
        }

        .clients-table th.sortable::after {
            content: ' ‚Üï';
            opacity: 0.5;
            font-size: 0.9rem;
        }

        .clients-table th.sort-asc::after {
            content: ' ‚Üë';
            opacity: 1;
        }

        .clients-table th.sort-desc::after {
            content: ' ‚Üì';
            opacity: 1;
        }

        .clients-table tbody tr {
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .clients-table tbody tr:hover {
            background: rgba(212, 175, 55, 0.1);
        }

        .clients-table td {
            padding: 14px 16px;
            color: rgba(212, 175, 55, 0.9);
        }

        .client-name-cell {
            font-weight: 600;
            color: #D4AF37;
        }

        .client-score-cell {
            font-weight: 600;
        }

        .score-high {
            color: #4ade80;
        }

        /* Favorite Star Styles */
        .favorite-cell {
            text-align: center;
            cursor: pointer;
            padding: 8px;
        }

        .favorite-star {
            font-size: 1.3rem;
            transition: all 0.2s ease;
            display: inline-block;
        }

        .favorite-inactive {
            color: rgba(212, 175, 55, 0.3);
        }

        .favorite-inactive:hover {
            color: #D4AF37;
            transform: scale(1.2);
        }

        .favorite-active {
            color: #D4AF37;
        }

        .favorite-active:hover {
            transform: scale(1.2);
        }

        /* Edit Mode Styles */
        .edit-mode .clients-table tbody tr {
            cursor: default;
        }

        .edit-mode .clients-table tbody tr:hover {
            background: rgba(212, 175, 55, 0.05);
        }

        .client-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #6495ed;
        }

        .clients-table tr.selected {
            background: rgba(100, 149, 237, 0.15) !important;
        }

        .score-medium {
            color: #fbbf24;
        }

        .score-low {
            color: #f87171;
        }

        .score-unrated {
            color: rgba(212, 175, 55, 0.5);
        }

        .client-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            background: rgba(212, 175, 55, 0.2);
            color: #D4AF37;
        }

        /* Problem row styles for invalid phone numbers */
        .problem-row {
            background: rgba(239, 68, 68, 0.08) !important;
            border-left: 3px solid rgba(239, 68, 68, 0.6) !important;
        }

        .problem-row:hover {
            background: rgba(239, 68, 68, 0.12) !important;
            cursor: pointer;
        }

        .problem-row td {
            position: relative;
        }

        /* Static styling only - no animation for elegance */

        .modal {
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #0d0d0d 100%);
            margin: 2% auto;
            padding: 40px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            position: relative;
        }

        .close {
            color: #D4AF37;
            float: right;
            font-size: 36px;
            font-weight: bold;
            line-height: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .close:hover,
        .close:focus {
            color: #F7E7AD;
            transform: scale(1.1);
        }

        .appointment-note {
            background: rgba(212, 175, 55, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 3px solid rgba(212, 175, 55, 0.5);
        }

        .appointment-note-date {
            font-size: 0.85rem;
            color: rgba(212, 175, 55, 0.7);
            margin-bottom: 8px;
        }

        .appointment-note-text {
            color: rgba(212, 175, 55, 0.95);
            line-height: 1.5;
        }

        .booking-card {
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
        }

        .booking-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .booking-card-date {
            font-weight: 600;
            color: #D4AF37;
        }

        .booking-card-details {
            color: rgba(212, 175, 55, 0.8);
            font-size: 0.9rem;
            line-height: 1.6;
        }
    </style>
</head>

<body>
    <div class="particles">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 6s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 8s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 10s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 12s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 14s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 16s;"></div>
    </div>

    <div class="container">
        <div class="sections-grid">
            {% if not authenticated %}
            <!-- Simplified Login Section -->
            <div class="section" id="loginSection">
                <h2><span class="section-icon">üîê</span>Professional Access</h2>
                <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 20px;">
                    Welcome to your elite professional platform. Enter your email to continue.
                </p>

                <!-- Informational Box -->
                <div
                    style="background: rgba(255, 215, 0, 0.1); border-left: 4px solid #D4AF37; padding: 20px; margin-bottom: 30px; border-radius: 8px;">
                    <p style="margin: 0; color: rgba(255, 255, 255, 0.9); line-height: 1.6;">
                        <strong>üìß How it works:</strong><br>
                        ‚Ä¢ If you have an existing account, we'll send a verification code to your email<br>
                        ‚Ä¢ New to our platform? Click "Sign Up" to create your professional account<br>
                        ‚Ä¢ Check your inbox and spam folder for the verification email
                    </p>
                </div>

                <form id="loginForm">
                    <!-- Simple Email Input -->
                    <div class="form-group" style="margin-bottom: 30px;">
                        <label for="userEmail"
                            style="font-size: 1.1rem; color: #D4AF37; margin-bottom: 10px; display: block;">Email
                            Address</label>
                        <input type="email" id="userEmail" name="email" required placeholder="your@email.com"
                            style="width: 100%; padding: 15px; font-size: 1.1rem; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2); background: rgba(255, 255, 255, 0.05); color: white;">
                    </div>

                    <!-- Action Buttons -->
                    <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                        <button type="submit" class="btn" style="flex: 1; min-width: 120px;">Next</button>
                        <button type="button" class="btn btn-add" onclick="showSignUp()"
                            style="flex: 1; min-width: 120px;">Sign Up</button>
                    </div>

                    <!-- Hidden Registration Section (shown when user clicks Sign Up) -->
                    <div id="registrationSection"
                        style="display: none; margin-top: 30px; padding: 25px; border-top: 2px solid rgba(255, 215, 0, 0.3);">
                        <h3 style="color: #D4AF37; margin-bottom: 20px;">Create Your Professional Account</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="regName">Professional Name *</label>
                                <input type="text" id="regName" name="name" placeholder="Dr. Alexandra Sterling">
                            </div>
                            <div class="form-group">
                                <label for="regBio">Professional Title (Optional)</label>
                                <select id="regBio" name="bio"
                                    style="width: 100%; padding: 12px; font-size: 1rem; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2); background: rgba(255, 255, 255, 0.05); color: white;">
                                    <option value="">Select your profession...</option>
                                    <option value="Hair Stylist">Hair Stylist</option>
                                    <option value="Massage Therapist">Massage Therapist</option>
                                    <option value="Esthetician">Esthetician</option>
                                    <option value="Personal Trainer">Personal Trainer</option>
                                    <option value="Nail Technician">Nail Technician</option>
                                    <option value="Makeup Artist">Makeup Artist</option>
                                    <option value="Therapist/Counselor">Therapist/Counselor</option>
                                    <option value="Music Instructor">Music Instructor</option>
                                    <option value="Fitness Coach">Fitness Coach</option>
                                    <option value="Nutritionist">Nutritionist</option>
                                    <option value="Life Coach">Life Coach</option>
                                    <option value="Tutor">Tutor</option>
                                    <option value="Consultant">Consultant</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="regPhone">Contact Number (Optional)</label>
                                <input type="tel" id="regPhone" name="phone" placeholder="(555) 555-5555 or 5555555555"
                                    maxlength="14">
                            </div>
                        </div>
                        <button type="button" class="btn" onclick="registerUser()"
                            style="width: 100%; margin-top: 20px;">Create Account & Send Verification</button>
                    </div>

                    <div id="verificationResponse" class="response"></div>
                </form>

                <!-- Verification Code Section (outside form to prevent Enter key from submitting) -->
                <div id="codeSection" style="display: none; margin-top: 30px;">
                    <div class="form-group">
                        <label for="verificationCode">Enter 6-Digit Verification Code</label>
                        <input type="text" id="verificationCode" maxlength="6" placeholder="123456"
                            onkeydown="if(event.key === 'Enter') { event.preventDefault(); verifyCode(); }"
                            style="text-align: center; font-size: 1.5rem; letter-spacing: 8px; width: 100%; padding: 15px;">
                    </div>
                    <button type="button" class="btn" onclick="verifyCode()"
                        style="width: 100%; margin-top: 15px;">Verify & Access Dashboard</button>
                </div>
            </div>
            {% else %}
            <!-- Authenticated Dashboard with Tabs -->

            <!-- Tab Navigation - Moved to top -->
            <div class="tab-navigation">
                <button class="tab-button active" onclick="switchTab('dashboard')">
                    <span class="tab-icon"></span>
                    <span>Dashboard</span>
                </button>
                <button class="tab-button" onclick="switchTab('bookings')">
                    <span class="tab-icon"></span>
                    <span>Bookings</span>
                </button>
                <button class="tab-button" onclick="switchTab('schedule')">
                    <span class="tab-icon"></span>
                    <span>Schedule & Availability</span>
                </button>
                <button class="tab-button" onclick="switchTab('services')">
                    <span class="tab-icon"></span>
                    <span>Services</span>
                </button>
                <button class="tab-button" onclick="switchTab('workplaces')">
                    <span class="tab-icon"></span>
                    <span>Workplaces</span>
                </button>
                <button class="tab-button" onclick="switchTab('clients')">
                    <span class="tab-icon"></span>
                    <span>Clients</span>
                </button>
            </div>

            <!-- Welcome Header -->
            <div class="section">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <div>
                        <h2 style="margin-bottom: 10px;"><span class="section-icon"></span>Welcome, {{ specialist.name
                            if specialist else 'Professional' }}</h2>
                        <p style="color: rgba(255, 255, 255, 0.7); margin: 0;">
                            Manage your professional services and availability from your secure dashboard.
                        </p>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button type="button" class="btn btn-outline" onclick="resetCompleteConfirmationPreference()"
                            title="Reset appointment completion confirmation"
                            style="padding: 10px 20px; font-size: 0.9rem;">
                            ‚öôÔ∏è Reset Confirmations
                        </button>
                        <button type="button" class="btn btn-add" onclick="logout()" style="padding: 10px 20px;">Sign
                            Out</button>
                    </div>
                </div>
            </div>

            <!-- Tab Contents -->

            <!-- Dashboard Tab -->
            <div id="tab-dashboard" class="tab-content active">
                <div class="section">
                    <h2><span class="section-icon"></span>Your Dashboard</h2>
                    <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 30px;">
                        Quick overview of your professional activity
                    </p>

                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div class="stat-card"
                            style="background: rgba(212, 175, 55, 0.1); padding: 30px; border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.2);">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;"></div>
                            <div style="font-size: 2rem; color: #D4AF37; font-weight: 700;" id="dashTotalBookings">0
                            </div>
                            <div style="color: rgba(212, 175, 55, 0.8);">Total Bookings</div>
                        </div>
                        <div class="stat-card"
                            style="background: rgba(212, 175, 55, 0.1); padding: 30px; border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.2);">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;"></div>
                            <div style="font-size: 2rem; color: #D4AF37; font-weight: 700;" id="dashConfirmedBookings">0
                            </div>
                            <div style="color: rgba(212, 175, 55, 0.8);">Confirmed</div>
                        </div>
                        <div class="stat-card"
                            style="background: rgba(212, 175, 55, 0.1); padding: 30px; border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.2);">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;"></div>
                            <div style="font-size: 2rem; color: #D4AF37; font-weight: 700;" id="dashTotalServices">0
                            </div>
                            <div style="color: rgba(212, 175, 55, 0.8);">Services Offered</div>
                        </div>
                        <div class="stat-card"
                            style="background: rgba(212, 175, 55, 0.1); padding: 30px; border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.2);">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;"></div>
                            <div style="font-size: 2rem; color: #D4AF37; font-weight: 700;" id="dashTotalWorkplaces">0
                            </div>
                            <div style="color: rgba(212, 175, 55, 0.8);">Workplaces</div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3 style="color: #D4AF37; margin-bottom: 20px;">Quick Actions</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button type="button" class="btn" onclick="switchTab('bookings')">View All
                                Bookings</button>
                            <button type="button" class="btn" onclick="switchTab('schedule')">Manage
                                Schedule</button>
                            <button type="button" class="btn" onclick="switchTab('services')">Add Services</button>
                            <button type="button" class="btn" onclick="switchTab('workplaces')">Manage
                                Workplaces</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bookings Tab -->
            <div id="tab-bookings" class="tab-content">
                <!-- Bookings Management Section -->
                <div class="section" id="bookingsSection">
                    <h2><span class="section-icon"></span>Your Bookings</h2>
                    <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 30px;">
                        View and manage all your client bookings. Stay organized with your professional schedule.
                    </p>

                    <!-- Bookings Filter -->
                    <div style="margin-bottom: 30px; display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label for="bookingStatusFilter" style="color: #D4AF37; font-weight: 500;">Filter by
                                Status:</label>
                            <select id="bookingStatusFilter" onchange="filterBookings()"
                                style="padding: 8px 15px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); background: rgba(212, 175, 55, 0.1); color: #D4AF37;">
                                <option value="all">All Bookings</option>
                                <option value="confirmed">Confirmed</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="loadBookings()"
                            style="padding: 8px 20px;">
                            Refresh
                        </button>
                    </div>

                    <!-- Bookings List -->
                    <div id="bookingsList" class="bookings-container">
                        <div class="loading-message"
                            style="text-align: center; color: rgba(212, 175, 55, 0.6); padding: 40px;">
                            Loading your bookings...
                        </div>
                    </div>

                    <div id="bookingsResponse" class="response"></div>
                </div>
            </div>

            <!-- Schedule & Availability Tab -->
            <div id="tab-schedule" class="tab-content">

                <!-- Exclusive Availability Section -->
                <div class="section">
                    <h2><span class="section-icon"></span>One-Time Availability</h2>
                    <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 20px;">
                        Set specific availability for individual dates
                    </p>
                    <div id="availabilityContainer">
                        <div class="dynamic-item">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Date</label>
                                    <input type="date" class="availability-date">
                                </div>
                                <div class="form-group">
                                    <label>Opening Hour</label>
                                    <input type="time" class="availability-start" value="09:00">
                                </div>
                                <div class="form-group">
                                    <label>Closing Hour</label>
                                    <input type="time" class="availability-end" value="17:00">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-add" onclick="addAvailabilityField()">+ Add Time Block</button>
                    <button type="button" class="btn" onclick="saveAvailability()">Set Availability</button>
                    <div id="availabilityResponse" class="response"></div>
                </div>

                <!-- Recurring Schedule Section -->
                <div class="section">
                    <h2><span class="section-icon">üìÖ</span>Weekly Recurring Schedule</h2>
                    <p class="section-subtitle">Click and drag to set your weekly availability</p>

                    <!-- Calendar Grid -->
                    <div class="calendar-wrapper">
                        <div class="calendar-controls"
                            style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 15px;">
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <button type="button" class="btn-small" onclick="clearWeeklySchedule()">üóëÔ∏è Clear
                                    All</button>
                                <button type="button" class="btn-small" onclick="copyDaySchedule()">üìã Copy Day</button>
                                <button type="button" class="btn-small" onclick="openApplyWeeksModal()">üìÜ Apply to
                                    Upcoming Weeks</button>
                            </div>

                            <!-- Time Range and Day Filters -->
                            <div style="display: flex; flex-direction: column; gap: 15px; align-items: flex-end;">
                                <!-- Time Range Filter -->
                                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <label
                                            style="color: rgba(255,255,255,0.7); font-size: 0.9rem; white-space: nowrap;">Time
                                            Range:</label>
                                        <select id="timeRangeStart" onchange="updateCalendarView()"
                                            style="padding: 6px 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,215,0,0.3); color: white; font-size: 0.9rem;">
                                            <option value="0">12 AM</option>
                                            <option value="1">1 AM</option>
                                            <option value="2">2 AM</option>
                                            <option value="3">3 AM</option>
                                            <option value="4">4 AM</option>
                                            <option value="5">5 AM</option>
                                            <option value="6" selected>6 AM</option>
                                            <option value="7">7 AM</option>
                                            <option value="8">8 AM</option>
                                            <option value="9">9 AM</option>
                                            <option value="10">10 AM</option>
                                            <option value="11">11 AM</option>
                                            <option value="12">12 PM</option>
                                            <option value="13">1 PM</option>
                                            <option value="14">2 PM</option>
                                            <option value="15">3 PM</option>
                                            <option value="16">4 PM</option>
                                            <option value="17">5 PM</option>
                                            <option value="18">6 PM</option>
                                            <option value="19">7 PM</option>
                                            <option value="20">8 PM</option>
                                            <option value="21">9 PM</option>
                                            <option value="22">10 PM</option>
                                            <option value="23">11 PM</option>
                                        </select>
                                        <span style="color: rgba(255,255,255,0.5);">to</span>
                                        <select id="timeRangeEnd" onchange="updateCalendarView()"
                                            style="padding: 6px 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,215,0,0.3); color: white; font-size: 0.9rem;">
                                            <option value="1">1 AM</option>
                                            <option value="2">2 AM</option>
                                            <option value="3">3 AM</option>
                                            <option value="4">4 AM</option>
                                            <option value="5">5 AM</option>
                                            <option value="6">6 AM</option>
                                            <option value="7">7 AM</option>
                                            <option value="8">8 AM</option>
                                            <option value="9">9 AM</option>
                                            <option value="10">10 AM</option>
                                            <option value="11">11 AM</option>
                                            <option value="12">12 PM</option>
                                            <option value="13">1 PM</option>
                                            <option value="14">2 PM</option>
                                            <option value="15">3 PM</option>
                                            <option value="16">4 PM</option>
                                            <option value="17">5 PM</option>
                                            <option value="18">6 PM</option>
                                            <option value="19">7 PM</option>
                                            <option value="20">8 PM</option>
                                            <option value="21">9 PM</option>
                                            <option value="22">10 PM</option>
                                            <option value="23" selected>11 PM</option>
                                            <option value="24">12 AM (next day)</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Day Visibility Filter -->
                                <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                                    <label
                                        style="color: rgba(255,255,255,0.7); font-size: 0.9rem; white-space: nowrap;">Show
                                        Days:</label>
                                    <label
                                        style="display: flex; align-items: center; gap: 4px; cursor: pointer; padding: 4px 8px; border-radius: 6px; background: rgba(255,255,255,0.05); transition: background 0.2s;">
                                        <input type="checkbox" id="dayToggle0" checked onchange="toggleDayVisibility(0)"
                                            style="cursor: pointer;">
                                        <span style="color: rgba(255,255,255,0.8); font-size: 0.85rem;">Mon</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 4px; cursor: pointer; padding: 4px 8px; border-radius: 6px; background: rgba(255,255,255,0.05); transition: background 0.2s;">
                                        <input type="checkbox" id="dayToggle1" checked onchange="toggleDayVisibility(1)"
                                            style="cursor: pointer;">
                                        <span style="color: rgba(255,255,255,0.8); font-size: 0.85rem;">Tue</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 4px; cursor: pointer; padding: 4px 8px; border-radius: 6px; background: rgba(255,255,255,0.05); transition: background 0.2s;">
                                        <input type="checkbox" id="dayToggle2" checked onchange="toggleDayVisibility(2)"
                                            style="cursor: pointer;">
                                        <span style="color: rgba(255,255,255,0.8); font-size: 0.85rem;">Wed</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 4px; cursor: pointer; padding: 4px 8px; border-radius: 6px; background: rgba(255,255,255,0.05); transition: background 0.2s;">
                                        <input type="checkbox" id="dayToggle3" checked onchange="toggleDayVisibility(3)"
                                            style="cursor: pointer;">
                                        <span style="color: rgba(255,255,255,0.8); font-size: 0.85rem;">Thu</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 4px; cursor: pointer; padding: 4px 8px; border-radius: 6px; background: rgba(255,255,255,0.05); transition: background 0.2s;">
                                        <input type="checkbox" id="dayToggle4" checked onchange="toggleDayVisibility(4)"
                                            style="cursor: pointer;">
                                        <span style="color: rgba(255,255,255,0.8); font-size: 0.85rem;">Fri</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 4px; cursor: pointer; padding: 4px 8px; border-radius: 6px; background: rgba(255,255,255,0.05); transition: background 0.2s;">
                                        <input type="checkbox" id="dayToggle5" checked onchange="toggleDayVisibility(5)"
                                            style="cursor: pointer;">
                                        <span style="color: rgba(255,255,255,0.8); font-size: 0.85rem;">Sat</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 4px; cursor: pointer; padding: 4px 8px; border-radius: 6px; background: rgba(255,255,255,0.05); transition: background 0.2s;">
                                        <input type="checkbox" id="dayToggle6" checked onchange="toggleDayVisibility(6)"
                                            style="cursor: pointer;">
                                        <span style="color: rgba(255,255,255,0.8); font-size: 0.85rem;">Sun</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div id="weeklyCalendar" class="weekly-calendar">
                            <!-- Time labels column -->
                            <div class="time-column" id="timeColumn">
                                <div class="time-header"></div>
                                <!-- Time labels will be dynamically generated -->
                            </div>

                            <!-- Day columns (Monday - Sunday) -->
                            <div class="day-column" data-day="0">
                                <div class="day-header">Monday</div>
                                <div class="time-slots" data-day="0"></div>
                            </div>
                            <div class="day-column" data-day="1">
                                <div class="day-header">Tuesday</div>
                                <div class="time-slots" data-day="1"></div>
                            </div>
                            <div class="day-column" data-day="2">
                                <div class="day-header">Wednesday</div>
                                <div class="time-slots" data-day="2"></div>
                            </div>
                            <div class="day-column" data-day="3">
                                <div class="day-header">Thursday</div>
                                <div class="time-slots" data-day="3"></div>
                            </div>
                            <div class="day-column" data-day="4">
                                <div class="day-header">Friday</div>
                                <div class="time-slots" data-day="4"></div>
                            </div>
                            <div class="day-column" data-day="5">
                                <div class="day-header">Saturday</div>
                                <div class="time-slots" data-day="5"></div>
                            </div>
                            <div class="day-column" data-day="6">
                                <div class="day-header">Sunday</div>
                                <div class="time-slots" data-day="6"></div>
                            </div>
                        </div>
                    </div>

                    <div
                        style="margin-top: 30px; display: flex; gap: 15px; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <div class="form-group" style="margin: 0; min-width: 200px;">
                                <label style="font-size: 0.9rem;">üìç Location</label>
                                <select id="recurringWorkplaceId"
                                    style="padding: 10px; font-size: 0.95rem; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,215,0,0.3); color: white; border-radius: 8px; cursor: pointer;">
                                    <option value="">Personal</option>
                                    <!-- Workplace options will be loaded dynamically -->
                                </select>
                            </div>
                            <div class="form-group" style="margin: 0; min-width: 200px;">
                                <label style="font-size: 0.9rem;">Effective Start Date</label>
                                <input type="date" id="recurringStartDate" style="padding: 10px; font-size: 0.95rem;">
                            </div>
                            <div class="form-group" style="margin: 0; min-width: 200px;">
                                <label style="font-size: 0.9rem;">End Date (Optional)</label>
                                <input type="date" id="recurringEndDate" style="padding: 10px; font-size: 0.95rem;">
                            </div>
                        </div>
                        <button type="button" class="btn" onclick="saveWeeklySchedule()" style="min-width: 200px;">
                            üíæ Save Weekly Schedule
                        </button>
                    </div>

                    <div id="recurringResponse" class="response"></div>

                    <!-- Existing Recurring Schedules - Visual Calendar View -->
                    <div id="existingRecurringSchedules" style="margin-top: 30px;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="margin: 0;">Current Recurring Schedules</h3>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <label for="scheduleViewTimeStart"
                                    style="font-size: 0.85rem; color: var(--color-text-secondary);">View:</label>
                                <select id="scheduleViewTimeStart" onchange="updateRecurringSchedulesCalendar()"
                                    style="padding: 6px 10px; font-size: 0.85rem; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 4px; color: white;">
                                    <option value="0">12 AM</option>
                                    <option value="6">6 AM</option>
                                    <option value="7">7 AM</option>
                                    <option value="8" selected>8 AM</option>
                                    <option value="9">9 AM</option>
                                    <option value="10">10 AM</option>
                                    <option value="12">12 PM</option>
                                </select>
                                <span style="color: var(--color-text-secondary); font-size: 0.85rem;">to</span>
                                <select id="scheduleViewTimeEnd" onchange="updateRecurringSchedulesCalendar()"
                                    style="padding: 6px 10px; font-size: 0.85rem; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 4px; color: white;">
                                    <option value="12">12 PM</option>
                                    <option value="14">2 PM</option>
                                    <option value="16">4 PM</option>
                                    <option value="17">5 PM</option>
                                    <option value="18" selected>6 PM</option>
                                    <option value="19">7 PM</option>
                                    <option value="20">8 PM</option>
                                    <option value="22">10 PM</option>
                                    <option value="24">12 AM</option>
                                </select>
                            </div>
                        </div>
                        <div id="recurringSchedulesCalendar" style="position: relative; overflow-x: auto;">
                            <!-- Calendar will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- PTO Management Section -->
                <div class="section">
                    <h2><span class="section-icon">Ô∏è</span>Time Off Management</h2>
                    <p class="section-subtitle">Block time for personal days, vacations, and holidays</p>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>Title</label>
                            <input type="text" id="ptoTitle" placeholder="e.g., Vacation, Personal Day, Holiday">
                        </div>
                        <div class="form-group">
                            <label>Type</label>
                            <select id="ptoType" class="form-select">
                                <option value="vacation">Vacation</option>
                                <option value="personal">Personal Day</option>
                                <option value="sick">Sick Leave</option>
                                <option value="holiday">Holiday</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>Start Date</label>
                            <input type="date" id="ptoStartDate">
                        </div>
                        <div class="form-group">
                            <label>End Date</label>
                            <input type="date" id="ptoEndDate">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="ptoFullDay" checked onchange="togglePtoTimes()"> Full Day(s)
                        </label>
                    </div>

                    <div id="ptoTimeFields" class="form-grid" style="display: none;">
                        <div class="form-group">
                            <label>Start Time</label>
                            <input type="time" id="ptoStartTime">
                        </div>
                        <div class="form-group">
                            <label>End Time</label>
                            <input type="time" id="ptoEndTime">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Description (Optional)</label>
                        <textarea id="ptoDescription" placeholder="Additional notes about this time off"></textarea>
                    </div>

                    <button type="button" class="btn" onclick="createPTOBlock()">Block Time Off</button>
                    <div id="ptoResponse" class="response"></div>

                    <!-- Existing PTO Blocks -->
                    <div id="existingPTOBlocks" style="margin-top: 30px;">
                        <h3>Scheduled Time Off</h3>
                        <div id="ptoBlocksList" class="schedules-list"></div>
                    </div>
                </div>

                <!-- Apply to Upcoming Weeks Modal -->
                <div id="applyWeeksModal" class="modal-overlay"
                    onclick="if(event.target === this) closeApplyWeeksModal()">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>üìÜ Apply to Upcoming Weeks</h3>
                            <button type="button" class="modal-close" onclick="closeApplyWeeksModal()">√ó</button>
                        </div>
                        <div class="modal-body">
                            <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 20px;">
                                Apply your current weekly schedule to multiple upcoming weeks
                            </p>

                            <div class="form-group">
                                <label style="color: #FFD700; margin-bottom: 8px; display: block;">Number of
                                    Weeks</label>
                                <select id="numberOfWeeks" onchange="updateApplyPreview()"
                                    style="width: 100%; padding: 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,215,0,0.3); color: white; font-size: 1rem;">
                                    <option value="1">1 week</option>
                                    <option value="2">2 weeks</option>
                                    <option value="3">3 weeks</option>
                                    <option value="4" selected>4 weeks</option>
                                    <option value="5">5 weeks</option>
                                    <option value="6">6 weeks</option>
                                    <option value="7">7 weeks</option>
                                    <option value="8">8 weeks</option>
                                    <option value="9">9 weeks</option>
                                    <option value="10">10 weeks</option>
                                    <option value="11">11 weeks</option>
                                    <option value="12">12 weeks</option>
                                </select>
                            </div>

                            <div class="form-group" style="margin-top: 20px;">
                                <label style="color: #FFD700; margin-bottom: 8px; display: block;">Starting From</label>
                                <input type="date" id="applyStartDate" onchange="updateApplyPreview()"
                                    style="width: 100%; padding: 12px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,215,0,0.3); color: white; font-size: 1rem;">
                            </div>

                            <div id="applyPreview"
                                style="margin-top: 20px; padding: 15px; background: rgba(255,215,0,0.05); border: 1px solid rgba(255,215,0,0.2); border-radius: 8px; color: rgba(255,255,255,0.8); font-size: 0.9rem;">
                                <strong style="color: #FFD700;">Preview:</strong> <span id="previewText">Select dates to
                                    see preview</span>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary"
                                onclick="closeApplyWeeksModal()">Cancel</button>
                            <button type="button" class="btn" onclick="applyToUpcomingWeeks()">Apply Schedule</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Services Tab -->
            <div id="tab-services" class="tab-content">
                <!-- Premium Services Section -->
                <div class="section">
                    <h2><span class="section-icon"></span>Add New Services</h2>
                    <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 20px;">
                        Create your premium service offerings for clients to book
                    </p>
                    <div id="servicesContainer">
                        <div class="dynamic-item">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Service Name</label>
                                    <input type="text" class="service-name" placeholder="Executive Health Consultation">
                                </div>
                                <div class="form-group">
                                    <label>Investment ($)</label>
                                    <input type="number" class="service-price" placeholder="500.00" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label>Duration (minutes)</label>
                                    <input type="number" class="service-duration" placeholder="60">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-add" onclick="addServiceField()">+ Add Premium Service</button>
                    <button type="button" class="btn" onclick="saveServices()">Publish Services</button>
                    <div id="servicesResponse" class="response"></div>
                </div>

                <!-- Existing Services Management Section -->
                <div class="section" id="existingServicesSection" style="display: none;">
                    <h2><span class="section-icon"></span>Manage Your Services</h2>
                    <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 20px;">
                        View, edit, or remove your existing services. Changes are saved automatically.
                    </p>

                    <div id="existingServicesList" class="existing-services-container">
                        <!-- Existing services will be loaded here -->
                    </div>

                    <div id="existingServicesResponse" class="response"></div>
                </div>
            </div>

            <!-- Workplaces Tab -->
            <div id="tab-workplaces" class="tab-content">
                <div class="section">
                    <h2><span class="section-icon"></span>Your Workplaces</h2>
                    <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 30px;">
                        Manage your places of business. Connect your barbershop, salon, or any location where you
                        provide services.
                    </p>

                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #D4AF37; margin-bottom: 15px;">Search Yelp for Your Business</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Business Name or Type</label>
                                <input type="text" id="yelpSearchTerm" placeholder="e.g., Modern Barbershop">
                            </div>
                            <div class="form-group">
                                <label>Location</label>
                                <input type="text" id="yelpSearchLocation" placeholder="e.g., San Francisco, CA">
                            </div>
                        </div>
                        <button type="button" class="btn" onclick="searchYelpBusinesses()">Search Yelp</button>
                        <div id="yelpSearchResults" style="margin-top: 20px;"></div>
                    </div>

                    <div>
                        <h3 style="color: #D4AF37; margin-bottom: 15px;">Or Add Custom Workplace</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Business Name *</label>
                                <input type="text" id="workplaceName" placeholder="My Business">
                            </div>
                            <div class="form-group">
                                <label>Address *</label>
                                <input type="text" id="workplaceAddress" placeholder="123 Main St">
                            </div>
                            <div class="form-group">
                                <label>City *</label>
                                <input type="text" id="workplaceCity" placeholder="San Francisco">
                            </div>
                            <div class="form-group">
                                <label>State</label>
                                <input type="text" id="workplaceState" placeholder="CA">
                            </div>
                            <div class="form-group">
                                <label>Zip Code</label>
                                <input type="text" id="workplaceZipCode" placeholder="94102">
                            </div>
                            <div class="form-group">
                                <label>Phone</label>
                                <input type="tel" id="workplacePhone" placeholder="+1 (555) 123-4567">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="workplaceDescription" placeholder="Describe your workplace..."></textarea>
                        </div>
                        <button type="button" class="btn" onclick="createCustomWorkplace()">Add Workplace</button>
                        <div id="workplaceResponse" class="response"></div>
                    </div>

                    <!-- My Workplaces List -->
                    <div id="myWorkplacesList" style="margin-top: 40px;">
                        <h3 style="color: #D4AF37; margin-bottom: 20px;">My Workplaces</h3>
                        <div id="workplacesContainer" class="workplaces-container">
                            <div class="loading-message"
                                style="text-align: center; color: rgba(212, 175, 55, 0.6); padding: 40px;">
                                Loading your workplaces...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Clients Tab -->
            <div id="tab-clients" class="tab-content">
                <div class="section">
                    <h2><span class="section-icon"></span>Your Clients</h2>
                    <p style="color: rgba(212, 175, 55, 0.8); margin-bottom: 30px;">
                        Manage your client relationships. View booking history and add notes.
                    </p>

                    <!-- Client Search/Filter -->
                    <div style="margin-bottom: 30px; display: flex; gap: 15px; flex-wrap: wrap;">
                        <input type="text" id="clientSearch" placeholder="Search clients by name, email, or phone..."
                            style="flex: 1; min-width: 250px; padding: 12px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); background: rgba(0, 0, 0, 0.3); color: #D4AF37;"
                            oninput="filterClients()">
                        <button class="btn btn-accent" onclick="openAddClientModal()"
                            style="padding: 12px 24px; background: linear-gradient(135deg, #D4AF37 0%, #F7E7AD 100%);">
                            ‚ûï Add a Client
                        </button>
                        <button class="btn btn-outline" onclick="openCsvUploadModal()" style="padding: 12px 24px;">
                            <span style="margin-right: 4px;">üì§</span> Upload Client List
                        </button>
                        <button class="btn btn-outline" id="editModeBtn" onclick="toggleEditMode()"
                            style="padding: 12px 24px;">
                            <span style="margin-right: 4px;">‚úèÔ∏è</span> Edit Clients
                        </button>
                    </div>

                    <!-- Edit Mode Actions (hidden by default) -->
                    <div id="editModeActions"
                        style="display: none; margin-bottom: 20px; padding: 20px; background: rgba(139, 168, 255, 0.08); border-radius: 12px; border: 1px solid rgba(139, 168, 255, 0.2);">
                        <div
                            style="display: flex; gap: 15px; align-items: center; justify-content: space-between; flex-wrap: wrap;">
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="checkbox" id="selectAllClients" onchange="toggleSelectAll()"
                                    style="width: 18px; height: 18px; cursor: pointer;">
                                <label for="selectAllClients"
                                    style="color: rgba(255, 255, 255, 0.9); cursor: pointer; font-weight: 500;">Select
                                    All</label>
                                <span id="selectedCount"
                                    style="color: var(--color-accent); margin-left: 10px; font-weight: 600;">0
                                    selected</span>
                            </div>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn btn-accent" onclick="bulkFavorite()" disabled id="bulkFavoriteBtn"
                                    style="padding: 10px 20px;">
                                    ‚≠ê Favorite
                                </button>
                                <button class="btn btn-outline" onclick="bulkUnfavorite()" disabled
                                    id="bulkUnfavoriteBtn" style="padding: 10px 20px;">
                                    ‚òÜ Unfavorite
                                </button>
                                <button class="btn btn-outline" onclick="bulkMessage()" disabled id="bulkMessageBtn"
                                    style="padding: 10px 20px;">
                                    üí¨ Message
                                </button>
                                <button class="btn btn-danger" onclick="bulkDeleteClients()" disabled id="bulkDeleteBtn"
                                    style="padding: 10px 20px;">
                                    üóëÔ∏è Delete
                                </button>
                                <button class="btn btn-outline" onclick="toggleEditMode()" style="padding: 10px 20px;">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Clients Stats -->
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div
                            style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.2);">
                            <div style="font-size: 2rem; margin-bottom: 5px;"></div>
                            <div style="font-size: 1.8rem; color: #D4AF37; font-weight: 700;" id="totalClientsCount">0
                            </div>
                            <div style="color: rgba(212, 175, 55, 0.8); font-size: 0.9rem;">Total Clients</div>
                        </div>
                        <div
                            style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.2);">
                            <div style="font-size: 2rem; margin-bottom: 5px;"></div>
                            <div style="font-size: 1.8rem; color: #D4AF37; font-weight: 700;" id="upcomingAppointments">
                                0</div>
                            <div style="color: rgba(212, 175, 55, 0.8); font-size: 0.9rem;">Upcoming</div>
                        </div>
                    </div>

                    <!-- Clients List -->
                    <div id="clientsList" class="clients-list">
                        <div class="loading-message"
                            style="text-align: center; color: rgba(212, 175, 55, 0.6); padding: 40px;">
                            Loading clients...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Complete Appointment Confirmation Modal -->
            <div id="completeAppointmentModal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width:500px;">
                    <h2 style="color: var(--color-accent); margin-bottom: 20px; font-size: 1.6rem; text-align: center;">
                        ‚úÖ Complete Appointment?
                    </h2>

                    <div
                        style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(212, 175, 55, 0.3);">
                        <p
                            style="color: rgba(255, 255, 255, 0.9); margin-bottom: 15px; text-align: center; font-size: 1rem;">
                            This action will:
                        </p>
                        <ul
                            style="color: rgba(255, 255, 255, 0.85); font-size: 0.95rem; list-style: none; padding: 0; margin: 0;">
                            <li style="padding: 8px 0; border-bottom: 1px solid rgba(212, 175, 55, 0.2);">
                                <span style="color: var(--color-accent); margin-right: 8px;">‚èπ</span> Stop the timer
                            </li>
                            <li style="padding: 8px 0; border-bottom: 1px solid rgba(212, 175, 55, 0.2);">
                                <span style="color: var(--color-accent); margin-right: 8px;">‚è±Ô∏è</span> Record the actual
                                duration
                            </li>
                            <li style="padding: 8px 0;">
                                <span style="color: var(--color-accent); margin-right: 8px;">‚úì</span> Mark the booking
                                as completed
                            </li>
                        </ul>
                    </div>

                    <!-- Don't ask again checkbox -->
                    <div
                        style="margin-bottom: 25px; padding: 15px; background: rgba(0, 0, 0, 0.3); border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.2);">
                        <label style="display: flex; align-items: center; cursor: pointer; user-select: none;">
                            <input type="checkbox" id="dontAskCompleteAgain"
                                style="width: 18px; height: 18px; margin-right: 10px; cursor: pointer; accent-color: var(--color-accent);">
                            <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem;">
                                Don't ask me again (you can reset this in settings)
                            </span>
                        </label>
                    </div>

                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-outline" onclick="closeCompleteAppointmentModal()"
                            style="flex: 1; padding: 12px;">
                            Cancel
                        </button>
                        <button class="btn btn-accent" onclick="confirmCompleteAppointment()"
                            style="flex: 1; padding: 12px;">
                            Complete Appointment
                        </button>
                    </div>
                </div>
            </div>

            <!-- Client Detail Modal -->
            <div id="clientModal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width:960px; max-height:90vh; overflow-y:auto;">
                    <button class="modal-close" aria-label="Close client details"
                        onclick="closeClientModal()">√ó</button>
                    <h2 id="modalClientName" class="font-display"
                        style="margin:0 0 28px; font-size:1.9rem; letter-spacing:.5px; background:linear-gradient(135deg,var(--color-accent),var(--color-accent-hover)); -webkit-background-clip:text; color:transparent;">
                        Client Details</h2>

                    <!-- Contact Information - Editable -->
                    <section class="card" style="margin-bottom:30px;">
                        <h3
                            style="margin:0 0 16px 0; font-size:1rem; letter-spacing:.6px; text-transform:uppercase; color:var(--color-accent);">
                            Contact Information</h3>

                        <!-- Simple form - always visible -->
                        <div style="display: grid; gap: 14px;">
                            <div class="form-group">
                                <label for="clientName">Name *</label>
                                <input type="text" id="clientName" placeholder="Client name" required>
                            </div>
                            <div class="form-group">
                                <label for="clientEmail">Email</label>
                                <input type="email" id="clientEmail" placeholder="client@example.com">
                                <span
                                    style="font-size: 0.7rem; color: var(--color-text-tertiary); margin-top: 2px; display: block;">Email
                                    or Phone required</span>
                            </div>
                            <div class="form-group">
                                <label for="clientPhone">Phone</label>
                                <input type="tel" id="clientPhone" placeholder="(555) 123-4567">
                                <span
                                    style="font-size: 0.7rem; color: var(--color-text-tertiary); margin-top: 2px; display: block;">10
                                    digits, will be auto-formatted</span>
                            </div>
                        </div>
                    </section>

                    <!-- Stats Grid -->
                    <section class="card" style="margin-bottom:30px;">
                        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:18px;">
                            <div>
                                <div class="muted" style="margin-bottom:4px;">Client Since</div>
                                <div id="modalClientSince">-</div>
                            </div>
                            <div>
                                <div class="muted" style="margin-bottom:4px;">Total Revenue</div>
                                <div id="modalClientRevenue">-</div>
                            </div>
                        </div>
                    </section>

                    <!-- Service Statistics -->
                    <section class="card" style="margin-bottom:30px;">
                        <h3
                            style="margin:0 0 16px; font-size:1rem; letter-spacing:.6px; text-transform:uppercase; color:var(--color-accent);">
                            üìä Service Statistics</h3>
                        <div id="serviceStatsContent">
                            <div style="color: var(--color-text-tertiary); text-align: center; padding: 20px;">
                                Loading statistics...
                            </div>
                        </div>
                    </section>

                    <!-- Contact Edit History -->
                    <section class="card" id="changelogSection" style="margin-bottom:30px; display:none;">
                        <div
                            style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                            <h3
                                style="margin:0; font-size:1rem; letter-spacing:.6px; text-transform:uppercase; color:var(--color-accent);">
                                üìù Edit History</h3>
                            <button class="btn btn-outline" onclick="toggleChangelog()"
                                style="padding: 6px 14px; font-size: 0.8rem;">
                                Hide
                            </button>
                        </div>
                        <p style="color: var(--color-text-tertiary); font-size: 0.75rem; margin-bottom: 12px;">Track of
                            all contact information changes</p>
                        <div id="changelogList" style="max-height: 300px; overflow-y: auto;"></div>
                    </section>

                    <!-- Profile Notes -->
                    <section class="card" style="margin-bottom:30px;">
                        <h3
                            style="margin:0 0 16px; font-size:1rem; letter-spacing:.6px; text-transform:uppercase; color:var(--color-accent);">
                            Client Profile</h3>
                        <div class="form-group" style="margin-bottom:16px;">
                            <label for="modalClientBio">Your Notes About This Client</label>
                            <textarea id="modalClientBio" rows="3"
                                placeholder="Add your notes about this client..."></textarea>
                        </div>
                        <div class="flex" style="gap:12px; margin-top:4px;">
                            <button class="btn btn-danger" style="flex:0 0 auto;" onclick="confirmDeleteClient()">üóëÔ∏è
                                Delete Client</button>
                        </div>
                    </section>

                    <!-- Appointment Notes -->
                    <section class="card" style="margin-bottom:30px;">
                        <h3
                            style="margin:0 0 16px; font-size:1rem; letter-spacing:.6px; text-transform:uppercase; color:var(--color-accent);">
                            Quick Note</h3>
                        <p style="color: var(--color-text-tertiary); font-size: 0.75rem; margin-bottom: 12px;">Add a
                            general note about this client (not tied to a specific appointment)</p>
                        <div class="flex-col" style="gap:10px; margin-bottom:10px;">
                            <textarea id="newAppointmentNote" rows="2"
                                placeholder="Add a general note about this client..."></textarea>
                            <button class="btn btn-outline" onclick="addAppointmentNote()">Add Note</button>
                        </div>
                        <div id="appointmentNotesList" style="margin-top:12px;"></div>
                    </section>

                    <!-- Save & Close Button -->
                    <div
                        style="position: sticky; bottom: 0; background: var(--color-bg-elevated); padding: 16px 0; margin: 20px 0; border-top: 2px solid var(--color-border); z-index: 10;">
                        <button class="btn btn-accent" onclick="saveAllAndClose()"
                            style="width: 100%; padding: 14px; font-size: 1.05rem; font-weight: 600;">
                            üíæ Save & Close
                        </button>
                        <div id="saveAllMessage" class="muted" style="margin-top:10px; text-align: center;"
                            aria-live="polite"></div>
                    </div>

                    <!-- Create New Booking -->
                    <section class="card" style="margin-bottom:30px;">
                        <h3
                            style="margin:0 0 16px 0; font-size:1rem; letter-spacing:.6px; text-transform:uppercase; color:var(--color-accent);">
                            üìÖ Create New Booking</h3>
                        <p style="color: var(--color-text-tertiary); font-size: 0.85rem; margin-bottom: 20px;">
                            Book an appointment on behalf of this client. All fields match the client booking portal.
                        </p>

                        <form id="manualBookingForm" style="display: grid; gap: 16px;">
                            <!-- Service Selection -->
                            <div class="form-group">
                                <label for="manualBookingService">Service *</label>
                                <select id="manualBookingService" required onchange="updateManualBookingServiceInfo()">
                                    <option value="">Select a service...</option>
                                </select>
                                <div id="manualBookingServiceInfo"
                                    style="margin-top: 8px; font-size: 0.8rem; color: var(--color-text-secondary);">
                                </div>
                            </div>

                            <!-- Date Selection -->
                            <div class="form-group">
                                <label for="manualBookingDate">Appointment Date *</label>
                                <input type="date" id="manualBookingDate" required
                                    onchange="loadManualBookingTimeSlots()">
                            </div>

                            <!-- Time Slot Selection -->
                            <div class="form-group">
                                <label for="manualBookingTime">Time Slot *</label>
                                <select id="manualBookingTime" required disabled>
                                    <option value="">Select date first...</option>
                                </select>
                                <div id="manualBookingTimeHelp"
                                    style="margin-top: 8px; font-size: 0.8rem; color: var(--color-text-tertiary);">
                                    Select a date to see available time slots
                                </div>
                            </div>

                            <!-- Optional Notes -->
                            <div class="form-group">
                                <label for="manualBookingNotes">Appointment Notes (Optional)</label>
                                <textarea id="manualBookingNotes" rows="3"
                                    placeholder="Any special requests or notes for this appointment..."></textarea>
                            </div>

                            <!-- Submit Button -->
                            <button type="button" class="btn btn-accent" onclick="submitManualBooking()"
                                style="padding: 12px; font-size: 1rem;">
                                üìÖ Create Booking
                            </button>
                        </form>

                        <div id="manualBookingResponse" style="margin-top: 16px; display: none;"></div>
                    </section>

                    <!-- Booking History -->
                    <div>
                        <h3 style="color: #D4AF37; margin-bottom: 20px;">Booking History</h3>

                        <!-- Future Appointments -->
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: rgba(212, 175, 55, 0.9); margin-bottom: 15px;">Upcoming Appointments
                            </h4>
                            <div id="modalFutureBookings">
                                <div style="color: rgba(212, 175, 55, 0.6); padding: 20px; text-align: center;">No
                                    upcoming appointments</div>
                            </div>
                        </div>

                        <!-- Past Appointments -->
                        <div>
                            <h4 style="color: rgba(212, 175, 55, 0.9); margin-bottom: 15px;">Past Appointments <span
                                    style="font-size: 0.75rem; color: var(--color-text-tertiary); font-weight: 400; margin-left: 8px;">(Click
                                    to add notes)</span></h4>
                            <div id="modalPastBookings">
                                <div style="color: rgba(212, 175, 55, 0.6); padding: 20px; text-align: center;">No past
                                    appointments</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delete Confirmation Modal -->
            <div id="deleteConfirmModal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 500px;">
                    <span class="close" onclick="closeDeleteConfirmModal()">&times;</span>
                    <h2 style="color: #dc2626; margin-bottom: 20px;">Delete Client?</h2>

                    <div
                        style="background: rgba(220, 38, 38, 0.1); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(220, 38, 38, 0.3);">
                        <p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 10px;">
                            Are you sure you want to delete <strong id="deleteClientName"
                                style="color: #dc2626;"></strong>?
                        </p>
                        <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem;">
                            This will permanently delete:
                        </p>
                        <ul
                            style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-top: 10px; margin-left: 20px;">
                            <li>Client profile (bio, rating, notes)</li>
                            <li>All appointment history records</li>
                            <li>Contact information</li>
                        </ul>
                        <p style="color: #dc2626; font-weight: 600; margin-top: 15px; font-size: 0.95rem;">
                            This action cannot be undone!
                        </p>
                    </div>

                    <div style="display: flex; gap: 15px;">
                        <button class="btn" onclick="closeDeleteConfirmModal()"
                            style="flex: 1; background: linear-gradient(135deg, #4b5563 0%, #374151 100%);">
                            Cancel
                        </button>
                        <button class="btn" onclick="deleteClient()"
                            style="flex: 1; background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                            Yes, Delete Client
                        </button>
                    </div>
                    <div id="deleteMessage" style="margin-top: 15px; text-align: center;"></div>
                </div>
            </div>

            <!-- Add Client Modal -->
            <div id="addClientModal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 500px;">
                    <span class="close" onclick="closeAddClientModal()">&times;</span>
                    <h2 style="margin-bottom: 8px;">‚ûï Add a Client</h2>
                    <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 24px;">
                        Add a new client to your list
                    </p>

                    <form id="addClientForm" onsubmit="submitNewClient(event)">
                        <div style="margin-bottom: 20px;">
                            <label for="newClientName"
                                style="display: block; margin-bottom: 8px; color: var(--color-accent); font-weight: 500;">
                                Name <span style="color: #ff6b6b;">*</span>
                            </label>
                            <input type="text" id="newClientName" required
                                style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); background: rgba(0, 0, 0, 0.3); color: white;"
                                placeholder="Client's full name">
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label for="newClientPhone"
                                style="display: block; margin-bottom: 8px; color: var(--color-accent); font-weight: 500;">
                                Phone <span style="color: #ff6b6b;">*</span>
                            </label>
                            <input type="tel" id="newClientPhone" required
                                style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); background: rgba(0, 0, 0, 0.3); color: white;"
                                placeholder="10-digit phone number">
                            <div style="margin-top: 6px; font-size: 0.85rem; color: rgba(255, 255, 255, 0.5);">
                                Enter 10 digits (no dashes or spaces)
                            </div>
                        </div>

                        <div style="margin-bottom: 24px;">
                            <label for="newClientEmail"
                                style="display: block; margin-bottom: 8px; color: var(--color-accent); font-weight: 500;">
                                Email
                            </label>
                            <input type="email" id="newClientEmail"
                                style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); background: rgba(0, 0, 0, 0.3); color: white;"
                                placeholder="client@example.com (optional)">
                        </div>

                        <div style="display: flex; gap: 15px;">
                            <button type="button" class="btn" onclick="closeAddClientModal()"
                                style="flex: 1; background: linear-gradient(135deg, #4b5563 0%, #374151 100%);">
                                Cancel
                            </button>
                            <button type="submit" class="btn btn-accent" style="flex: 1;">
                                Add Client
                            </button>
                        </div>
                    </form>

                    <div id="addClientMessage" style="margin-top: 15px;" aria-live="polite"></div>
                </div>
            </div>

            <!-- CSV Upload Modal -->
            <div id="csvUploadModal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 600px;">
                    <span class="close" onclick="closeCsvUploadModal()">&times;</span>
                    <h2 style="margin-bottom: 8px;">üì§ Upload Client List</h2>
                    <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 24px;">
                        Import multiple clients at once with a CSV file
                    </p>

                    <div
                        style="background: rgba(139, 168, 255, 0.08); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(139, 168, 255, 0.2);">
                        <p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 15px; font-weight: 500;">
                            <span style="color: var(--color-accent);">üìã Required Format:</span> Your CSV should include
                            these columns:
                        </p>
                        <div
                            style="background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 8px; font-family: monospace; font-size: 0.85rem; color: var(--color-accent); line-height: 1.6;">
                            <div style="color: rgba(255, 255, 255, 0.5); margin-bottom: 8px;">name,phone,email</div>
                            <div>John Smith,5550100,john@example.com</div>
                            <div>Jane Doe,5550200,jane@example.com</div>
                            <div>Bob Johnson,5550300,</div>
                        </div>
                        <div
                            style="margin-top: 16px; padding: 12px; background: rgba(139, 168, 255, 0.1); border-radius: 8px; border-left: 3px solid var(--color-accent);">
                            <div style="color: rgba(255, 255, 255, 0.8); font-size: 0.85rem; line-height: 1.5;">
                                <div style="margin-bottom: 6px;"><strong style="color: var(--color-accent);">‚úì
                                        Name</strong> ‚Äî Required for all clients</div>
                                <div style="margin-bottom: 6px;"><strong style="color: var(--color-accent);">‚úì
                                        Phone</strong> ‚Äî Required (10 digits)</div>
                                <div><strong style="color: var(--color-accent);">‚óã Email</strong> ‚Äî Optional</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <input type="file" id="csvFileInput" accept=".csv" style="display: none;"
                            onchange="handleCsvFileSelect(event)">
                        <button class="btn" onclick="document.getElementById('csvFileInput').click()"
                            style="width: 100%; padding: 20px; font-size: 1.1rem;">
                            Choose CSV File
                        </button>
                        <div id="selectedFileName"
                            style="margin-top: 10px; text-align: center; color: rgba(212, 175, 55, 0.8); font-size: 0.9rem;">
                        </div>
                    </div>

                    <div style="display: flex; gap: 15px;">
                        <button class="btn" onclick="closeCsvUploadModal()"
                            style="flex: 1; background: linear-gradient(135deg, #4b5563 0%, #374151 100%);">
                            Cancel
                        </button>
                        <button class="btn" id="uploadCsvBtn" onclick="uploadCsvFile()" disabled
                            style="flex: 1; opacity: 0.5; cursor: not-allowed;">
                            Upload Clients
                        </button>
                    </div>
                    <div id="uploadMessage" style="margin-top: 15px;" aria-live="polite"></div>
                    <div id="uploadProgress" style="margin-top: 10px; display: none;">
                        <div
                            style="background: rgba(0, 0, 0, 0.3); border-radius: 10px; overflow: hidden; height: 8px;">
                            <div id="uploadProgressBar"
                                style="background: linear-gradient(90deg, #D4AF37, #F7E7AD); height: 100%; width: 0%; transition: width 0.3s;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {% endif %}
        </div>
    </div>

    <script>
        // Set specialist ID from template (needed before module loads)
        {% if authenticated and specialist %}
        window.currentSpecialistId = {{ specialist.id }};
        {% else %}
        window.currentSpecialistId = null;
        {% endif %}

        // Create placeholder functions to prevent errors during module loading
        // These will be replaced once main.js loads
        let retryCount = {};
        const MAX_RETRIES = 10;

        const placeholderFn = (name) => function (...args) {
            if (!retryCount[name]) retryCount[name] = 0;

            if (retryCount[name] >= MAX_RETRIES) {
                console.error(`${name} failed to load after ${MAX_RETRIES} retries. Check browser console for module loading errors.`);
                return;
            }

            retryCount[name]++;
            console.warn(`${name} called before modules loaded - retry ${retryCount[name]}/${MAX_RETRIES}`);

            setTimeout(() => {
                if (typeof window[name] === 'function' && !window[name].toString().includes('placeholderFn')) {
                    // Real function is now loaded, call it
                    window[name](...args);
                } else if (retryCount[name] < MAX_RETRIES) {
                    // Still not loaded, retry
                    window[name](...args);
                }
            }, 200);
        };

        // Placeholders for onclick handlers (will be overwritten by modules when loaded)
        window.switchTab = placeholderFn('switchTab');
        window.loadClients = placeholderFn('loadClients');
        window.viewClientDetail = placeholderFn('viewClientDetail');
        window.updateBookingStatus = placeholderFn('updateBookingStatus');
        window.loadBookings = placeholderFn('loadBookings');
        window.searchYelpBusinesses = placeholderFn('searchYelpBusinesses');

        console.log('[INIT] Placeholder functions created, loading modules...');
    </script>

    <!-- Load modular JavaScript -->
    <script type="module" src="/static/js/main.js?v=20251116-typescript"></script>

    <script>
        // Fallback logout function in case module hasn't loaded yet
        if (typeof window.logout === 'undefined') {
            window.logout = async function () {
                try {
                    const response = await fetch('/auth/logout', {
                        method: 'POST',
                        credentials: 'include'
                    });
                    window.location.href = '/professional';
                } catch (error) {
                    console.error('Logout error:', error);
                    window.location.href = '/professional';
                }
            };
            console.log('[FALLBACK] logout function created');
        }
    </script>

    <script>
        // ==================== MODULE COORDINATION ====================
        // Note: All functionality has been extracted to /static/js/ modules
        // This file now only contains HTML structure and minimal initialization

        // ==================== NOTE: TAB NAVIGATION & INITIALIZATION ====================
        // Tab switching (switchTab), dashboard stats (loadDashboardStats), 
        // and initialization (DOMContentLoaded, loadExistingData) are now in /static/js/navigation.js
        // and handled by main.js

        // ==================== SERVICE MANAGEMENT ====================
        // NOTE: All service management functions moved to /static/js/services.js including:
        // - displayExistingServices(), editService(), cancelEdit(), saveServiceEdit()
        // - confirmDeleteService(), deleteService(), getCurrentServices()
        // - loadExistingServices(), addServiceField(), saveServices()

        async function saveAvailability() {
            if (!currentSpecialistId) {
                showResponse('availabilityResponse', 'Please establish your profile first', 'error');
                return;
            }

            const availabilityItems = document.querySelectorAll('.dynamic-item');
            const slots = [];

            availabilityItems.forEach(item => {
                const dateInput = item.querySelector('.availability-date');
                const startInput = item.querySelector('.availability-start');
                const endInput = item.querySelector('.availability-end');

                if (dateInput && startInput && endInput) {
                    const date = dateInput.value;
                    const start_time = startInput.value + ':00';
                    const end_time = endInput.value + ':00';

                    if (date && start_time && end_time) {
                        slots.push({ date, start_time, end_time });
                    }
                }
            });

            if (slots.length === 0) {
                showResponse('availabilityResponse', 'Please set at least one availability block', 'error');
                return;
            }

            try {
                const response = await fetch(`/specialist/${currentSpecialistId}/availability`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(slots)
                });

                const result = await response.json();
                if (response.ok) {
                    showResponse('availabilityResponse', ` ${slots.length} exclusive time blocks set successfully!`, 'success');
                } else {
                    showResponse('availabilityResponse', `Scheduling failed: ${result.detail}`, 'error');
                }
            } catch (error) {
                showResponse('availabilityResponse', `Connection error: ${error.message}`, 'error');
            }
        }

        // ========================
        // AUTHENTICATION & VERIFICATION
        // ========================
        // NOTE: All authentication functions moved to /static/js/auth.js including:
        // - proceedWithEmail(), showSignUp(), registerUser(), verifyCode()
        // - sendVerificationCode(), hideLogin()

        // ========================
        // BOOKINGS MANAGEMENT
        // ========================
        // NOTE: All booking functions moved to /static/js/bookings.js including:
        // - loadBookings(), displayBookings(), createBookingCard(), filterBookings()
        // - updateBookingStatus(), startAppointment(), finishAppointment()
        // - confirmCompleteAppointment(), closeCompleteAppointmentModal()
        // - openClientProfile(), resetCompleteConfirmationPreference()
        // - Timer functions: startTimer(), stopTimer()
        // - formatDuration() for session durations

        // ========================
        // UTILITY FUNCTIONS
        // ========================
        // NOTE: showResponse() is now in /static/js/utils.js and exposed via main.js

        // ========================
        // CALENDAR & SCHEDULE MANAGEMENT
        // ========================
        // NOTE: All calendar and schedule functions moved to /static/js/schedule.js including:
        // - PTO Management: togglePtoTimes(), createPTOBlock(), loadPTOBlocks(), deletePTOBlock()
        // - Recurring Schedules: createRecurringSchedule(), loadRecurringSchedules(), deleteRecurringSchedule()
        // - Weekly Calendar: initializeWeeklyCalendar(), updateCalendarView(), toggleDayVisibility()
        // - Calendar Drag & Drop: All selection, resizing, and preview functions
        // - Calendar Utilities: deleteTimeBlock(), clearWeeklySchedule(), copyDaySchedule()
        // - Save & Apply: saveWeeklySchedule(), openApplyWeeksModal(), updateApplyPreview(), closeApplyWeeksModal(), applyToUpcomingWeeks()

        // ========================
        // WORKPLACE MANAGEMENT
        // ========================
        // NOTE: All workplace management functions moved to /static/js/workplaces.js including:
        // - searchYelpBusinesses(), addWorkplaceFromYelp(), createCustomWorkplace()
        // - loadMyWorkplaces(), toggleWorkplaceStatus(), removeWorkplace()

        // ========================
        // CLIENT BULK OPERATIONS
        // ========================
        // NOTE: All client bulk operations moved to /static/js/client-bulk-operations.js including:
        // - Edit Mode: toggleEditMode(), toggleSelectAll(), updateSelectedCount()
        // - Bulk Actions: bulkDeleteClients(), bulkFavorite(), bulkUnfavorite(), bulkMessage()
        // - Add Client: openAddClientModal(), closeAddClientModal(), submitNewClient()

        // ========================
        // CSV UPLOAD
        // ========================
        // NOTE: All CSV upload functions moved to /static/js/csv-upload.js including:
        // - openCsvUploadModal(), closeCsvUploadModal()
        // - handleCsvFileSelect(), uploadCsvFile()

        // ========================
        // CLIENT DETAIL MODAL
        // ========================
        // NOTE: All client detail modal functions moved to /static/js/client-detail.js including:
        // - viewClientDetail(), closeClientModal(), saveClientProfile()
        // - Manual booking: updateManualBookingServiceInfo(), loadManualBookingTimeSlots(),
        //   selectAlternativeDate(), submitManualBooking()
        // - Appointment notes: addAppointmentNote(), toggleAppointmentNoteEditor(), saveAppointmentNote()
        // - Client deletion: confirmDeleteClient(), closeDeleteConfirmModal(), deleteClient()
        // - Changelog: toggleChangelog()

        // NOTE: Client auto-loading when switching tabs is now handled in navigation.js switchTab()
    </script>
</body>

</html>